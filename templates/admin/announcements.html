{% extends "admin/admin_base.html" %}
{% block content %}
<h2 class="text-2xl font-bold mb-4">Quản lý thông báo</h2>

<!-- Nút mở modal -->
<div class="flex justify-end mb-4">
    <button onclick="openModal()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">+ Tạo thông
        báo</button>
</div>

<!-- Bảng danh sách thông báo -->
<div class="bg-white shadow rounded overflow-x-auto">
    <table class="w-full text-sm">
        <thead class="bg-gray-100">
            <tr>
                <th class="px-4 py-2 text-left">STT</th>                
                <th class="px-4 py-2 text-left">Tiêu đề</th>
                <th class="px-4 py-2 text-left">Ngày tạo</th>
                <th class="px-4 py-2 text-left">Người đăng</th>
            </tr>
        </thead>
        <tbody>
            {% for ann in announcements %}
            <tr class="border-t">
                <td class="px-4 py-2">{{ loop.index }}</td>
                <td class="px-4 py-2">
                    <a href="{{ url_for('admin.announcement_detail', ann_id=ann.id) }}"
                        class="text-blue-600 hover:underline">{{ ann.title }}</a>
                </td>
                <td class="px-4 py-2">{{ ann.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
                <td class="px-4 py-2">{{ ann.admin.fullname if ann.admin else 'Admin' }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="3" class="px-4 py-4 italic text-gray-500 text-center">Chưa có thông báo nào</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Modal tạo thông báo -->
<div id="createAnnModal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-xl p-6 relative">
        <h3 class="text-xl font-bold mb-4">Tạo thông báo mới</h3>

        <form method="POST" action="{{ url_for('admin.create_announcement') }}" enctype="multipart/form-data" class="space-y-4">
            <div>
                <input type="text" name="title" placeholder="Tiêu đề" required
                    class="w-full border px-3 py-2 rounded focus:ring focus:ring-blue-300">
            </div>
            <div>
                <textarea name="content" rows="6" placeholder="Nội dung" required
                    class="w-full border px-3 py-2 rounded focus:ring focus:ring-blue-300"></textarea>
            </div>
            <div>
                <label class="block font-medium">Ảnh đính kèm</label>
                <input type="file" name="image" accept="image/*"
                    class="w-full border px-3 py-2 rounded focus:ring focus:ring-blue-300">
            </div>
            <div class="flex justify-end gap-3">
                <button type="button" onclick="closeModal()"
                    class="px-4 py-2 bg-gray-400 text-white rounded hover:bg-gray-500">Hủy</button>
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Đăng</button>
            </div>
        </form>

        <!-- Nút đóng -->
        <button onclick="closeModal()" class="absolute top-3 right-3 text-gray-500 text-xl">✕</button>
    </div>
</div>

<script>
    function openModal() {
        document.getElementById("createAnnModal").classList.remove("hidden");
    }
    function closeModal() {
        document.getElementById("createAnnModal").classList.add("hidden");
    }
</script>
{% endblock %}